name: Report lemonade-sdk install size

on:
  pull_request:

permissions:
  contents: read

jobs:
  install-report:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'
      - name: Measure installation stats
        run: |
          set -euo pipefail
          python -m venv venv
          source venv/bin/activate
          python -m pip install --upgrade pip tabulate
          START=$(date +%s)
          python -m pip install lemonade-sdk
          END=$(date +%s)
          INSTALL_TIME=$((END-START))
          {
            echo "## Installation Report"
            echo "Total install time: ${INSTALL_TIME} seconds"
            python .github/workflows/install_report.py
          } | tee -a "$GITHUB_STEP_SUMMARY"

